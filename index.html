<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BOBOY — Интерактивное меню</title>
  <meta name="description" content="BOBOY — Uzbek Eatery. Полное меню, блюдо дня, выбор языка, адаптивный интерфейс." />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
  <link rel="preload" as="image" href="4.webp">
  <link rel="preload" as="image" href="6.webp">
  <link rel="preload" as="image" href="10.webp">
  <link rel="preload" as="image" href="Лагман Уйгурский.webp">
  <link rel="preload" as="image" href="шашлыки.webp">
  <link rel="preload" as="image" href="казан-кабоб.webp">
  <style>
    :root{--brand-beige:#FDF6E9;--brand-champagne-gold:#E0C097;--brand-dark-text:#404040;--brand-blue:#1D4ED8;--brand-deep-blue:#0b2e78}
    html,body{background:var(--brand-beige);color:var(--brand-dark-text);font-family:'Open Sans',sans-serif}
    #decor-layer{position:relative;z-index:0;pointer-events:none}
    #left-art{position:fixed;left:0;top:0;width:clamp(360px,48vw,640px);height:auto;opacity:1;z-index:0}
    #donkey-art{position:fixed;right:0;bottom:0;width:clamp(220px,24vw,360px);height:auto;opacity:1;z-index:0}
    @media (max-width:768px){#left-art{width:90vw}#donkey-art{right:6px;bottom:8px;width:40vw}}
    header,section,main,footer{position:relative;z-index:1}
    .no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}.no-scrollbar::-webkit-scrollbar{display:none}
    .font-heading{font-family:'Montserrat',sans-serif}
    h1,h2,h3{font-family:'Montserrat',sans-serif;color:var(--brand-blue);font-weight:800}
    .section-title{color:var(--brand-deep-blue);-webkit-text-stroke:1px #fff;paint-order:stroke fill;text-shadow:-1px -1px 0 #fff,1px -1px 0 #fff,-1px 1px 0 #fff,1px 1px 0 #fff,0 0 2px #fff}
    .fade-in{animation:fade .6s cubic-bezier(.25,.46,.45,.94) both}@keyframes fade{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
    .btn-primary{background:var(--brand-blue);color:#fff;transition:all .25s ease;box-shadow:0 4px 20px rgba(29,78,216,.22)}.btn-primary:hover{background:#1E40AF;transform:translateY(-2px);box-shadow:0 10px 28px rgba(29,78,216,.28)}
    .card{background:#fff;border:1px solid #EAE0D5;border-radius:1.25rem;transition:box-shadow .3s ease,transform .3s ease;box-shadow:0 5px 25px rgba(64,64,64,.08);overflow:hidden}
    .card:hover{transform:translateY(-6px);box-shadow:0 16px 40px rgba(64,64,64,.14)}
    .input-styled{background:#fff;border:1px solid #EAE0D5;outline:none;transition:all .2s ease}.input-styled:focus{box-shadow:0 0 0 3px rgba(224,192,151,.6);border-color:var(--brand-champagne-gold)}
    .hero-bg{position:relative;background:#fff}
    .hero-bg::before{content:'';position:absolute;inset:0;background-image:url('4.webp');background-size:cover;background-position:center bottom;z-index:0;opacity:.24}
    .hero-bg::after{content:'';position:absolute;inset:0;background:linear-gradient(to top,rgba(253,246,233,1) 0%,rgba(253,246,233,.55) 35%,rgba(253,246,233,0) 60%);z-index:0}
    .hero-content{position:relative;z-index:1}
    .chip{border:1px solid #EAE0D5;background:#fff}.chip.active{border-color:var(--brand-blue);background:rgba(29,78,216,.08);color:var(--brand-blue)}
    .swipe-hint{position:fixed;left:50%;transform:translateX(-50%);bottom:78px;background:rgba(0,0,0,.55);color:#fff;font-weight:600;border-radius:999px;padding:8px 14px;z-index:25;animation:hintfade 2.4s ease forwards;font-size:12px}
    @keyframes hintfade{0%{opacity:0;transform:translate(-50%,20px)}20%{opacity:1;transform:translate(-50%,0)}80%{opacity:1}100%{opacity:0}}
    .footer-art{position:relative;z-index:0;overflow:hidden}
    .footer-art::before{content:'';position:absolute;inset:0;background:url('10.webp') center bottom/cover no-repeat;opacity:.85;pointer-events:none;z-index:0}
    .footer-art::after{content:'';position:absolute;inset:0;background:linear-gradient(to top,rgba(253,246,233,.92) 0%,rgba(253,246,233,.86) 40%,rgba(253,246,233,.68) 100%);z-index:0}
    .footer-art>.footer-contrast{position:relative;z-index:1}
    .slide-out{opacity:0;transition:opacity .24s ease}.slide-in{opacity:1;transition:opacity .24s ease}
    @keyframes slideOut{from{opacity:1;transform:translateX(0)}to{opacity:0;transform:translateX(-40px)}}
    @keyframes slideIn{from{opacity:0;transform:translateX(40px)}to{opacity:1;transform:translateX(0)}}
    #hero-text{will-change:height;contain:layout paint}
    #hero-slider{touch-action:pan-y}
    /* плавное перекрестное затемнение для картинки блюд */
    .hero-img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;transform:translateX(0);will-change:transform}
    .hero-img.show{}
    .hero-arrow{position:absolute;top:50%;transform:translateY(-50%);width:44px;height:44px;border-radius:9999px;background:#fff;border:1px solid #EAE0D5;display:flex;align-items:center;justify-content:center;box-shadow:0 8px 24px rgba(0,0,0,.08);z-index:5;opacity:.95}
    .hero-arrow:hover{box-shadow:0 12px 28px rgba(0,0,0,.14)}.hero-arrow.left{left:8px}.hero-arrow.right{right:8px}
    @media (max-width:768px){.hero-arrow{width:40px;height:40px}}
    .dish-modal{position:fixed;inset:0;background:rgba(0,0,0,.55);backdrop-filter:blur(2px);display:none;align-items:center;justify-content:center;z-index:60}
    .dish-card{background:#fff;border-radius:1.25rem;box-shadow:0 24px 70px rgba(0,0,0,.3);max-width:min(960px,calc(100% - 32px));width:100%;overflow:hidden;border:1px solid #EAE0D5}
    .lang-gate{position:fixed;inset:0;background:rgba(0,0,0,.5);backdrop-filter:blur(4px);display:none;align-items:center;justify-content:center;z-index:50}
    .lang-card{background:#fff;border-radius:1.25rem;box-shadow:0 20px 60px rgba(0,0,0,.25);padding:28px;max-width:520px;width:calc(100% - 32px)}
    .lang-grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:12px;margin-top:16px}
    .lang-tile{display:flex;align-items:center;justify-content:center;border:1px solid #EAE0D5;border-radius:14px;padding:14px 10px;font-weight:700;cursor:pointer;transition:transform .15s ease,box-shadow .2s ease}
    .lang-tile:hover{transform:translateY(-2px);box-shadow:0 10px 24px rgba(0,0,0,.08)}
  </style>
</head>
<body class="min-h-screen">
  <div id="decor-layer" aria-hidden="true">
    <img id="left-art" src="6.webp" alt="Фоновая иллюстрация слева">
    <img id="donkey-art" src="img399.webp" alt="Насреддин с ослом">
  </div>

  <header class="sticky top-0 z-40 backdrop-blur-xl bg-white/80 border-b border-gray-200/60">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex items-center justify-between gap-4">
      <div class="flex items-center gap-3">
        <img src="BOBOY_logo_basic_blue (1).png" alt="BOBOY" class="h-10 w-auto">
        <div class="leading-tight">
          <div class="font-heading font-extrabold text-2xl tracking-wide" style="color:var(--brand-blue)">BOBOY</div>
          <div id="subtitle" class="text-xs uppercase tracking-wider" style="color:var(--brand-dark-text)">UZBEK EATERY</div>
        </div>
      </div>
      <div class="flex items-center gap-3">
        <button id="change-language" class="inline-flex items-center px-3 py-2 rounded-lg bg-white/0 hover:bg-gray-500/5 transition text-sm" aria-label="Язык">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="opacity-70"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>
        </button>
      </div>
    </div>
  </header>

  <section id="hero-slider" class="relative overflow-hidden hero-bg select-none">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24 hero-content">
      <div class="grid md:grid-cols-2 gap-12 items-center">
        <div id="hero-text" class="fade-in">
          <div class="inline-flex items-center gap-2.5 px-4 py-1.5 rounded-full" style="background-color:rgba(184,158,115,0.1);border:1px solid rgba(184,158,115,0.3)">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="#d02a2a" stroke="#d02a2a" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M11.16 2.37A3.37 3.37 0 008.25 2a3.37 3.37 0 00-2.91.37c-2.53.85-3.41 4.33-2.22 6.58 1.9 3.63 6.62 7.74 6.88 7.94a.5.5 0 00.7 0c.26-.2 4.98-4.31 6.88-7.94 1.19-2.25.31-5.73-2.22-6.58A3.37 3.37 0 0015.75 2a3.37 3.37 0 00-2.91.37l-1.68 1.55-1.68-1.55z"/></svg>
            <span id="dishOfDayLabel" class="text-sm uppercase tracking-wider font-semibold" style="color:var(--brand-accent)">Блюдо дня</span>
          </div>
          <h1 id="dishOfDayName" class="mt-5 text-4xl lg:text-6xl font-extrabold leading-tight tracking-tighter">—</h1>
          <p id="dishOfDayDesc" class="mt-5 text-lg max-w-prose leading-relaxed">—</p>
          <div class="mt-8 flex items-center gap-4" id="dishOfDayBadges"></div>
        </div>
        <div class="fade-in" style="animation-delay:.1s">
          <div class="relative card p-3 shadow-2xl">
            <div class="relative aspect-square rounded-xl overflow-hidden">
              <img id="hero-img-a" src="Лагман Уйгурский.webp" alt="Лагман уйгурский" class="hero-img show">
              <img id="hero-img-b" src="Лагман Уйгурский.webp" alt="" aria-hidden="true" class="hero-img">
            </div>
          </div>
        </div>
      </div>
    </div>
    <button class="hero-arrow left" aria-label="Предыдущий слайд">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>
    </button>
    <button class="hero-arrow right" aria-label="Следующий слайд">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
    </button>
  </section>

  <section class="sticky top-[73px] z-30 border-b border-gray-200/80 bg-white/80 backdrop-blur-xl">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex flex-col gap-4">
      <div class="flex flex-col md:flex-row md:items-center gap-4">
        <div class="relative flex-1">
          <svg class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
          <input id="search" placeholder="Поиск по меню…" class="w-full pl-12 pr-4 py-3 text-base rounded-full input-styled">
        </div>
        <button id="vegOnlyBtn" class="inline-flex items-center justify-center gap-2 px-5 py-3 rounded-full border transition-colors border-gray-200 hover:bg-gray-50 font-semibold text-sm">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none" stroke="currentColor" class="text-green-500"><path d="M7 14c-3 0-4-1-4-4 0-3 2-6 5-7 3 1 5 4 5 7s-1 4-4 4-2-1-2-1zM4 15c2 2 6 2 8 0"/></svg>
          <span id="vegOnlyLabel">Только вегетарианское</span>
        </button>
      </div>
      <div id="cat-chips" class="flex gap-2 overflow-x-auto no-scrollbar pb-1"></div>
    </div>
  </section>

  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 md:py-14" id="menu-root"></main>

  <footer class="border-t border-gray-200/80 bg-white footer-art">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 grid md:grid-cols-3 gap-8 footer-contrast">
      <div>
        <div class="font-heading font-semibold text-xl" style="color:var(--brand-blue)">BOBOY</div>
        <p id="footerCopy" class="text-sm mt-2 leading-relaxed">Атмосфера Узбекистана: уникальные ароматы и вкусы.</p>
      </div>
      <div>
        <h3 id="locationsLabel" class="font-heading font-semibold mb-4">Адреса</h3>
        <ul class="space-y-3 text-sm">
          <li class="flex items-start gap-3"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="mt-0.5 opacity-70 flex-shrink-0"><path d="M21 10c0 6-9 12-9 12S3 16 3 10a9 9 0 1118 0z"></path><circle cx="12" cy="10" r="3"></circle></svg> <div><strong>Tashkent City Mall</strong><br>3-й этаж, +998 77 109 88 77</div></li>
          <li class="flex items-start gap-3"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="mt-0.5 opacity-70 flex-shrink-0"><path d="M21 10c0 6-9 12-9 12S3 16 3 10a9 9 0 1118 0z"></path><circle cx="12" cy="10" r="3"></circle></svg> <div><strong>ул. Тараса Шевченко, 38А</strong><br>+998 77 235 88 77</div></li>
        </ul>
      </div>
      <div>
        <h3 class="font-heading font-semibold mb-4">Instagram</h3>
        <a href="#" class="inline-flex items-center gap-2 hover:text-brand-accent font-semibold transition-colors">@boboycafe_uz</a>
        <p id="allergyNote" class="text-xs text-gray-700 mt-4">Пожалуйста, предупредите нас о любых аллергиях. Состав блюд может незначительно отличаться.</p>
      </div>
    </div>
  </footer>

  <div id="lang-gate" class="lang-gate">
    <div class="lang-card">
      <div class="font-heading text-2xl font-extrabold text-center">Выберите язык</div>
      <div class="text-center text-sm text-gray-600 mt-1">Choose language / Tilni tanlang</div>
      <div class="lang-grid">
        <button class="lang-tile" data-lang="ru">Русский</button>
        <button class="lang-tile" data-lang="en">English</button>
        <button class="lang-tile" data-lang="uz">Oʻzbekcha</button>
      </div>
    </div>
  </div>

  <div id="dish-modal" class="dish-modal">
    <div class="dish-card relative md:grid md:grid-cols-2 gap-0">
      <button id="dish-modal-close" class="absolute top-3 right-3 inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/90 border border-gray-200 hover:bg-white transition" aria-label="Закрыть">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
      </button>
      <div class="aspect-square bg-gray-100 overflow-hidden">
        <img id="dish-modal-image" src="казан-кабоб.webp" alt="Казан-кабоб" class="w-full h-full object-cover">
      </div>
      <div class="p-6 md:p-8 flex flex-col">
        <h3 id="dish-modal-title" class="font-heading text-2xl md:text-3xl font-extrabold"></h3>
        <p id="dish-modal-desc" class="mt-3 text-gray-700"></p>
        <div class="mt-auto pt-6"><span id="dish-modal-price" class="inline-flex items-center gap-2 px-4 py-2 rounded-full text-lg border bg-amber-500/10 border-amber-500/20 text-amber-800 font-bold"></span></div>
      </div>
    </div>
  </div>

  <script>
  const STR={
    ru:{topbarSubtitle:"UZBEK EATERY",changeLanguage:"Язык",dishOfDay:"Блюдо дня",dishOfDayDesc:"Подборка хитов BOBOY: лагман, шашлыки и казан‑кабаб.",chefRecommends:"Рекомендует шеф",vegetarian:"Вегетарианское",searchPlaceholder:"Поиск по меню…",vegOnly:"Только вегетарианское",locations:"Адреса",footerCopy:"Атмосфера Узбекистана: уникальные ароматы и вкусы.",allergyNote:"Пожалуйста, предупредите нас о любых аллергиях. Состав блюд может незначительно отличаться.",addToOrder:"В заказ",cartTitle:"Ваш заказ / Калькулятор",cartEmpty:"Ваша корзина пуста",subtotal:"Подытог",serviceCharge:"Процент за обслуживание (%)",total:"ИТОГО",clearCart:"Очистить заказ",tabOrder:"Принять заказ",tabGroup:"Расчет на группу",groupItem:"Выберите блюдо или сет:",groupPeople:"Количество человек:",groupPerPerson:"Цена на человека:",groupTotal:"Общая стоимость:"},
    en:{topbarSubtitle:"UZBEK EATERY",changeLanguage:"Language",dishOfDay:"Dish of the Day",dishOfDayDesc:"BOBOY best-sellers: lagman, kebabs and kazan kebab.",chefRecommends:"Chef recommends",vegetarian:"Vegetarian",searchPlaceholder:"Search the menu…",vegOnly:"Vegetarian only",locations:"Locations",footerCopy:"Immerse yourself in Uzbekistan’s unique tastes and aromas.",allergyNote:"Please let us know about any allergies. Ingredients may vary slightly.",addToOrder:"Add to order",cartTitle:"Your Order / Calculator",cartEmpty:"Your cart is empty",subtotal:"Subtotal",serviceCharge:"Service Charge (%)",total:"TOTAL",clearCart:"Clear Order",tabOrder:"Take Order",tabGroup:"Group Calculator",groupItem:"Select item or set:",groupPeople:"Number of people:",groupPerPerson:"Price per person:",groupTotal:"Total cost:"},
    uz:{topbarSubtitle:"UZBEK EATERY",changeLanguage:"Til",dishOfDay:"Kun taomi",dishOfDayDesc:"BOBOY xitlari: lag'mon, kabob va qozon kabob.",chefRecommends:"Shef tavsiya qiladi",vegetarian:"Vegetarian",searchPlaceholder:"Menyu bo‘yicha qidirish…",vegOnly:"Faqat vegetarian",locations:"Manzillar",footerCopy:"Oʻzbekistonning oʻziga xos tamlari va hidlari.",allergyNote:"Allergiyangiz bo‘lsa, oldindan ayting. Tarkib biroz farq qilishi mumkin.",addToOrder:"Qo'shish",cartTitle:"Sizning buyurtmangiz / Kalkulyator",cartEmpty:"Sizning savatingiz bo'sh",subtotal:"Jami",serviceCharge:"Xizmat haqi (%)",total:"UMUMIY",clearCart:"Buyurtmani tozalash",tabOrder:"Buyurtma berish",tabGroup:"Guruh uchun hisoblash",groupItem:"Taom yoki to'plamni tanlang:",groupPeople:"Odamlar soni:",groupPerPerson:"Bir kishi uchun narx:",groupTotal:"Umumiy narx:"}
  };

  const ITEMS=(()=>{const I=(id,name,price,opts={})=>({id,name,price,description:{ru:'',en:'',uz:''},...opts});return{
    khach_ap:I("khach_ap",{ru:"Хачапури по-аджарски",en:"Khachapuri (Adjarian)",uz:"Xachapuri-Ajar"},73000,{veg:true}),
    kazan_kebab:I("kazan_kebab",{ru:"Казан-кабоб",en:"Kazan Kebab",uz:"Qozon kabob"},159000),
    suzma:I("suzma",{ru:"Сузма",en:"Suzma",uz:"Suzma"},25000,{veg:true}),
    marinated_veg:I("marinated_veg",{ru:"Маринованные овощи",en:"Marinated Vegetables",uz:"Tuzlangan sabzavotlar"},38000,{veg:true}),
    kulcha:I("kulcha",{ru:"Домашний хлеб (кулча)",en:"House Bread (Kulcha)",uz:"Non (Kulcha)"},15000,{veg:true}),
    garlic_nan:I("garlic_nan",{ru:"Чесночный нан",en:"Garlic Nan",uz:"Sarimsoqli non"},28000,{veg:true}),
    khach_meg:I("khach_meg",{ru:"Хачапури по-мегрельски",en:"Khachapuri (Megrelian)",uz:"Xachapuri-Megrel"},73000,{veg:true}),
    cheb_beef:I("cheb_beef",{ru:"Мини-чебурек с говядиной (4 шт)",en:"Mini Cheburek with Beef (4 pcs)",uz:"Mini cheburek (go‘shtli) (4 dona)"},40000),
    cheb_cheese:I("cheb_cheese",{ru:"Мини-чебурек с сыром (4 шт)",en:"Mini Cheburek with Cheese (4 pcs)",uz:"Mini cheburek (pishloqli) (4 dona)"},35000,{veg:true}),
    somsa_trad:I("somsa_trad",{ru:"Самса традиционная",en:"Somsa Traditional",uz:"Tandir somsa"},20000),
    somsa_olot:I("somsa_olot",{ru:"Самса Олот",en:"Somsa Olot",uz:"Olot somsa"},15000),
    turkish_meze:I("turkish_meze",{ru:"Турецкий мезе сет",en:"Turkish Meze Set",uz:"Turkcha mezze seti"},95000),
    achik:I("achik",{ru:"Ачик-чучук",en:"Achik Chuchuk",uz:"Achik chuchuk"},29000,{veg:true}),
    caesar:I("caesar",{ru:"Цезарь с курицей",en:"Caesar with Chicken",uz:"Salat Sezar tovuqli"},89000),
    greek:I("greek",{ru:"Греческий салат",en:"Greek Salad",uz:"Greck salad"},79000,{veg:true}),
    bakhor:I("bakhor",{ru:"Салат Бахор",en:"Salad Bakhor",uz:"Bahor salati"},45000,{veg:true}),
    olivier:I("olivier",{ru:"Оливье",en:"Olivier Salad",uz:"Salat Olivye"},63000),
    eggplant_tempura:I("eggplant_tempura",{ru:"Салат с баклажаном темпура",en:"Eggplant Tempura Salad",uz:"Qarsildoq baqlajon"},69000,{veg:true}),
    choban:I("choban",{ru:"Чобан салат",en:"Choban Salad",uz:"Choban salat"},69000,{veg:true}),
    kainatma:I("kainatma",{ru:"Кайнатма шурпа",en:"Kainatma Shurpa",uz:"Qaynatma sho‘rva"},79000),
    lagman_uyghur:I("lagman_uyghur",{ru:"Лагман уйгурский",en:"Lagman Uyghur",uz:"Uyg‘ur lag‘mon"},63000),
    mastava:I("mastava",{ru:"Мастава",en:"Mastava",uz:"Mastava"},55000),
    chicken_noodle:I("chicken_noodle",{ru:"Куриный суп с лапшой",en:"Chicken Noodle Soup",uz:"Tovuqli sho‘rva"},49000),
    chuchvara:I("chuchvara",{ru:"Чучвара",en:"Chuchvara",uz:"Chuchvara"},61000),
    moshxurda:I("moshxurda",{ru:"Мошхурда",en:"Moshxurda",uz:"Moshxo‘rda"},65000),
    lentil:I("lentil",{ru:"Чечевичный суп",en:"Lentil Soup",uz:"Yasmiq sho'rva"},40000,{veg:true}),
    festive_pilaf:I("festive_pilaf",{ru:"Праздничный плов",en:"Festive Pilaf",uz:"Osh"},50000),
    say_beef:I("say_beef",{ru:"Сай говяжий",en:"Beef SAY",uz:"Go‘shtli Say"},89000),
    manti:I("manti",{ru:"Манты (1 шт)",en:"Manti (1 pc)",uz:"Manti (1 dona)"},19000),
    fried_lagman:I("fried_lagman",{ru:"Лагман жареный",en:"Fried Lagman",uz:"Qovurma lag‘mon"},73000),
    norin:I("norin",{ru:"Норин",en:"Norin",uz:"Norin"},93000),
    minced_beef:I("minced_beef",{ru:"Кийма шашлык",en:"Minced Beef Kebab",uz:"Qiyma kabob"},35000),
    beef_kebab:I("beef_kebab",{ru:"Шашлык из говядины",en:"Beef Kebab",uz:"Mol jaz"},43000),
    lamb_kebab:I("lamb_kebab",{ru:"Шашлык из баранины",en:"Lamb Kebab",uz:"Qo‘y jaz"},45000),
    lamb_chops:I("lamb_chops",{ru:"Каре ягнёнка",en:"Lamb chops",uz:"Qo‘zi qovurg‘asi"},75000),
    chicken_wings:I("chicken_wings",{ru:"Куриные крылья",en:"Chicken Wings",uz:"Tovuq qanoti"},42000),
    veg_kebab:I("veg_kebab",{ru:"Овощной шашлык",en:"Vegetarian Kebab",uz:"Sabzavotli kabob"},35000,{veg:true}),
    napoleon:I("napoleon",{ru:"Наполеон",en:"Napoleon",uz:"Napoleon"},69000,{veg:true}),
    honey_cake:I("honey_cake",{ru:"Медовик",en:"Honey Cake",uz:"Medovik"},72000,{veg:true}),
    san_sebastian:I("san_sebastian",{ru:"Сан-Себастьян",en:"San Sebastian Cheesecake",uz:"San Sebastyan"},79000,{veg:true}),
    bakhlava:I("bakhlava",{ru:"Пахлава",en:"Bakhlava",uz:"Paxlava"},59000,{veg:true}),
    classic_mojito:I("classic_mojito",{ru:"Мохито классический",en:"Classic Mojito",uz:"Klassik moxito"},41000,{veg:true}),
    ayran:I("ayran",{ru:"Айран",en:"Ayran",uz:"Ayron"},35000,{veg:true}),
    black_tea:I("black_tea",{ru:"Чай черный",en:"Black tea",uz:"Qora choy"},29000,{veg:true})
  }})();

  const CATEGORIES={
    starters:["suzma","marinated_veg","kulcha","garlic_nan","khach_ap","khach_meg","cheb_beef","cheb_cheese","somsa_trad","somsa_olot","turkish_meze"],
    salads:["achik","caesar","greek","bakhor","olivier","eggplant_tempura","choban"],
    soups:["kainatma","lagman_uyghur","mastava","chicken_noodle","chuchvara","moshxurda","lentil"],
    mains:["festive_pilaf","say_beef","manti","kazan_kebab","fried_lagman","norin"],
    kebabs:["minced_beef","beef_kebab","lamb_kebab","lamb_chops","chicken_wings","veg_kebab"],
    desserts:["napoleon","honey_cake","san_sebastian","bakhlava"],
    drinks:["classic_mojito","ayran","black_tea"]
  };
  const CAT_NAMES={ru:{starters:"Закуски",salads:"Салаты",soups:"Супы",mains:"Горячие блюда",kebabs:"Шашлыки",desserts:"Десерты",drinks:"Напитки"},en:{starters:"Starters",salads:"Salads",soups:"Soups",mains:"Main Courses",kebabs:"Kebabs",desserts:"Desserts",drinks:"Drinks"},uz:{starters:"Yaxna taomlar",salads:"Salatlar",soups:"Sho‘rvalar",mains:"Asosiy taomlar",kebabs:"Kaboblar",desserts:"Shirinliklar",drinks:"Ichimliklar"}};

  let lang=localStorage.getItem('boboy_lang')||'ru';
  let vegOnly=false; let query='';
  let cart=JSON.parse(localStorage.getItem('boboy_cart'))||[];
  let activeCatIdx=parseInt(sessionStorage.getItem('active_cat_idx')||'0')||0;

  const $=s=>document.querySelector(s); const $$=s=>Array.from(document.querySelectorAll(s));
  const fmt=n=>new Intl.NumberFormat('ru-RU').format(n)+' UZS';
  const locName=o=>o[lang]||o.ru;

  function renderTopCopy(){
    $('#subtitle').textContent=STR[lang].topbarSubtitle;$('#change-language')?.setAttribute('aria-label',STR[lang].changeLanguage);
    $('#vegOnlyLabel').textContent=STR[lang].vegOnly;const s=$('#search');if(s)s.placeholder=STR[lang].searchPlaceholder;
    $('#locationsLabel').textContent=STR[lang].locations;$('#footerCopy').textContent=STR[lang].footerCopy;$('#allergyNote').textContent=STR[lang].allergyNote;renderCategoryChips();
  }

  const HERO_IDS=["lagman_uyghur","beef_kebab","kazan_kebab"];
  const HERO_IMG_SRC={lagman_uyghur:"Лагман Уйгурский.webp",beef_kebab:"шашлыки.webp",kazan_kebab:"казан-кабоб.webp"};
  const HERO_DESC_BY_ID={
    ru:{lagman_uyghur:"Классический лагман на ручной лапше.",beef_kebab:"Сочные шашлыки с мангала.",kazan_kebab:"Казан‑кабаб — мясо и картофель в казане."},
    en:{lagman_uyghur:"Classic Uyghur lagman with hand‑pulled noodles.",beef_kebab:"Juicy kebabs from the grill.",kazan_kebab:"Kazan kebab — hearty meat & potatoes."},
    uz:{lagman_uyghur:"Qo'l tortilgan lag'mon.",beef_kebab:"Shirador kaboblar.",kazan_kebab:"Qozon kabob — go'sht va kartoshka."}
  };
  let heroIdx=0,heroTimer=null,isHeroAnimating=false;
  async function applyHero(id, dir=1){
    if(isHeroAnimating) return; 
    isHeroAnimating = true;
    const d = ITEMS[id];
    if(!d){ isHeroAnimating=false; return; }
    const name = $('#dishOfDayName');
    const desc = $('#dishOfDayDesc');
    const badges = $('#dishOfDayBadges');

    // плавное обновление текста
    [name,desc].forEach(el=>{
      if(!el) return; el.classList.remove('slide-in'); el.classList.add('slide-out');
    });
    setTimeout(()=>{
      if(name) name.textContent = locName(d.name);
      if(desc) desc.textContent = HERO_DESC_BY_ID[lang]?.[id] || STR[lang].dishOfDayDesc;
      if(badges) badges.innerHTML = `<span class="inline-flex items-center gap-2 px-4 py-2 rounded-full text-lg border bg-amber-500/10 border-amber-500/20 text-amber-800 font-bold">${fmt(d.price)}</span>`;
      [name,desc].forEach(el=>{ if(!el) return; el.classList.remove('slide-out'); el.classList.add('slide-in'); });
      setTimeout(()=>{ [name,desc].forEach(el=>el&&el.classList.remove('slide-in')); }, 420);
    }, 60);

    // слайд изображений (предварительно декодированная картинка)
    await slideHeroImage(HERO_IMG_SRC[id], locName(d.name), dir);
    isHeroAnimating = false;
  }
  let _heroFlip=false;
  async function slideHeroImage(src,alt,dir=1){
    const a=$('#hero-img-a'), b=$('#hero-img-b');
    const incoming = _heroFlip ? a : b; const outgoing = _heroFlip ? b : a;
    if(!incoming||!outgoing) return;
    if(incoming.src!==src) incoming.src=src; incoming.alt=alt||'';
    try{ if(incoming.decode) await incoming.decode(); }catch(e){}
    [incoming,outgoing].forEach(img=>{img.style.transition='none'});
    incoming.style.transform = `translateX(${dir>0?100:-100}%)`;
    outgoing.style.transform = 'translateX(0%)';
    // force reflow
    void incoming.offsetWidth;
    const dur=550, easing='cubic-bezier(.22,.61,.36,1)';
    incoming.style.transition=`transform ${dur}ms ${easing}`;
    outgoing.style.transition=`transform ${dur}ms ${easing}`;
    incoming.style.transform='translateX(0%)';
    outgoing.style.transform=`translateX(${dir>0?-100:100}%)`;
    await new Promise(res=>{
      let done=0; const onEnd=(e)=>{ if(e.propertyName==='transform'){ e.currentTarget.removeEventListener('transitionend',onEnd); if(++done===2) res(); } };
      incoming.addEventListener('transitionend',onEnd); outgoing.addEventListener('transitionend',onEnd);
    });
    _heroFlip=!_heroFlip;
  }
  function initHeroImages(){
    const id=HERO_IDS[heroIdx]; const src=HERO_IMG_SRC[id]; const alt=locName(ITEMS[id].name);
    const a=$('#hero-img-a'), b=$('#hero-img-b');
    if(a){a.src=src; a.alt=alt; a.style.transition='none'; a.style.transform='translateX(0)';}
    if(b){b.src=src; b.alt=''; b.style.transition='none'; b.style.transform='translateX(100%)';}
    _heroFlip=false;
  }
  function startHero(){ initHeroImages(); applyHero(HERO_IDS[heroIdx], 1); restartHeroTimer(); }
  function restartHeroTimer(){ if(heroTimer) clearInterval(heroTimer); heroTimer=setInterval(()=>{ if(isHeroAnimating) return; heroIdx=(heroIdx+1)%HERO_IDS.length; applyHero(HERO_IDS[heroIdx], 1); }, 5000); }
  function nextHero(){ if(isHeroAnimating) return; heroIdx=(heroIdx+1)%HERO_IDS.length; applyHero(HERO_IDS[heroIdx], 1); restartHeroTimer(); }
  function prevHero(){ if(isHeroAnimating) return; heroIdx=(heroIdx-1+HERO_IDS.length)%HERO_IDS.length; applyHero(HERO_IDS[heroIdx], -1); restartHeroTimer(); }
  function enableHeroManual(){
    const area=document.getElementById('hero-slider'); if(!area) return;
    area.querySelector('.hero-arrow.left')?.addEventListener('click',prevHero);
    area.querySelector('.hero-arrow.right')?.addEventListener('click',nextHero);
    let sx=null,sy=null,active=false;const TH=40;
    area.addEventListener('touchstart',e=>{const t=e.changedTouches[0];sx=t.clientX;sy=t.clientY;active=true},{passive:true});
    area.addEventListener('touchmove',e=>{if(!active)return;const t=e.changedTouches[0];const dx=t.clientX-sx;const dy=t.clientY-sy;if(Math.abs(dx)>Math.abs(dy)*1.5&&Math.abs(dx)>TH){active=false;if(dx<0)nextHero();else prevHero();}},{passive:true});
    area.addEventListener('touchend',()=>{active=false},{passive:true});
    let px=null,py=null,down=false;
    area.addEventListener('pointerdown',e=>{px=e.clientX;py=e.clientY;down=true});
    area.addEventListener('pointerup',e=>{if(!down)return;const dx=e.clientX-px;const dy=e.clientY-py;if(Math.abs(dx)>Math.abs(dy)*1.5&&Math.abs(dx)>TH){if(dx<0)nextHero();else prevHero();}down=false});
    window.addEventListener('keydown',e=>{if(e.key==='ArrowLeft')prevHero();else if(e.key==='ArrowRight')nextHero()});
  }

  function buildCard(item){
    const el=document.createElement('div');
    el.className='card p-4 flex flex-col cursor-pointer'; el.dataset.id=item.id;
    el.innerHTML=`<div class="flex-grow"><div class="flex justify-between items-start"><h4 class="font-heading font-bold text-lg pr-2">${locName(item.name)}</h4>${item.veg?`<div class="w-7 h-7 flex-shrink-0 rounded-full bg-green-100 flex items-center justify-center" title="${STR[lang].vegetarian}"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" fill=\"none\" stroke=\"currentColor\" class=\"text-green-600\"><path d=\"M7 14c-3 0-4-1-4-4 0-3 2-6 5-7 3 1 5 4 5 7s-1 4-4 4-2-1-2-1zM4 15c2 2 6 2 8 0\"/></svg></div>`:''}</div><p class="text-sm mt-1 text-gray-600">${locName(item.description)||''}</p></div><div class="flex items-center justify-between mt-4"><div class="text-lg font-bold" style="color:var(--brand-dark-text)">${fmt(item.price)}</div></div>`;
    return el
  }

  function matchesQuery(item){const text=(locName(item.name)).toLowerCase();const okQuery=!query||text.includes(query.toLowerCase());const okVeg=!vegOnly||item.veg;return okQuery&&okVeg}

  const activeCatId=()=>Object.keys(CATEGORIES)[activeCatIdx]||Object.keys(CATEGORIES)[0];
  function renderActiveCategory(){
    const root=$('#menu-root'); if(!root) return;
    root.innerHTML='';
    const catId=activeCatId();
    const list=CATEGORIES[catId].map(k=>ITEMS[k]).filter(matchesQuery);
    const sec=document.createElement('section'); sec.id=`cat-${catId}`; sec.className='fade-in';
    sec.innerHTML=`<h2 class="section-title text-3xl font-bold mb-8">${CAT_NAMES[lang][catId]}</h2>`;
    const grid=document.createElement('div'); grid.className='grid sm:grid-cols-2 lg:grid-cols-3 gap-8';
    if(list.length===0){ grid.innerHTML=`<div class='text-gray-500'>Ничего не найдено в этой категории.</div>` } else { list.forEach(it=>grid.appendChild(buildCard(it))) }
    sec.appendChild(grid); root.appendChild(sec);
    setActiveChip(catId);
  }

  function renderCategoryChips(){const box=$('#cat-chips');if(!box)return;const ids=Object.keys(CATEGORIES);box.innerHTML='';ids.forEach(id=>{const b=document.createElement('button');b.className='chip px-3 py-1.5 rounded-full text-sm font-semibold whitespace-nowrap';b.textContent=CAT_NAMES[lang][id];b.dataset.cat=id;b.onclick=()=>goToCategoryId(id);box.appendChild(b)});setActiveChip(activeCatId())}
  function setActiveChip(id){$$('#cat-chips .chip').forEach(c=>c.classList.toggle('active',c.dataset.cat===id))}

  function showCart(){} function hideCart(){} const saveCart=()=>localStorage.setItem('boboy_cart',JSON.stringify(cart)); function addToCart(id){} function updateCartQuantity(id,delta){} function renderCart(){} function calculateTotal(){} function clearCart(){}

  function bindLangButtons(){$$('#change-language,[data-lang]').forEach(btn=>{btn.addEventListener('click',()=>{const l=btn.getAttribute('data-lang');if(!l){document.body.dispatchEvent(new Event('open-lang-gate'));return}lang=l;localStorage.setItem('boboy_lang',l);init()})})}

  function setupEventListeners(){
    $('#search')?.addEventListener('input',e=>{query=e.target.value;renderActiveCategory()});
    $('#vegOnlyBtn')?.addEventListener('click',()=>{vegOnly=!vegOnly;$('#vegOnlyBtn').classList.toggle('bg-green-100',vegOnly);$('#vegOnlyBtn').classList.toggle('border-green-300',vegOnly);renderActiveCategory()});
    document.body.addEventListener('open-lang-gate',showLangGate);
    $('#lang-gate')?.addEventListener('click',e=>{const t=e.target.closest('.lang-tile');if(!t)return;lang=t.dataset.lang;localStorage.setItem('boboy_lang',lang);hideLangGate();init()});
    const onSR=(()=>{let raf=0;return()=>{if(raf)return;raf=requestAnimationFrame(()=>{raf=0;updateDecorPositions();});};})();
    window.addEventListener('scroll',onSR,{passive:true});window.addEventListener('resize',onSR);
    $('#donkey-art')?.addEventListener('load',onSR);$('#left-art')?.addEventListener('load',onSR);
    if(window.matchMedia('(max-width: 767px)').matches){enableCategorySwipe();showSwipeHintOnce()}
    $('#menu-root')?.addEventListener('click',e=>{const card=e.target.closest('.card');if(!card)return;const id=card.dataset.id;if(id==='kazan_kebab')openDishModal()});
  }

  function enableCategorySwipe(){let x0=null,y0=null,locked=false;const TH=50;document.body.addEventListener('touchstart',e=>{const t=e.changedTouches[0];x0=t.clientX;y0=t.clientY;locked=false},{passive:true});document.body.addEventListener('touchmove',e=>{if(x0===null||locked)return;const t=e.changedTouches[0],dx=t.clientX-x0,dy=t.clientY-y0;if(Math.abs(dx)>Math.abs(dy)*1.6&&Math.abs(dx)>TH){locked=true;goToSiblingCategory(dx<0?1:-1)}},{passive:true});document.body.addEventListener('touchend',()=>{x0=y0=null;locked=false},{passive:true})}

  function goToCategoryId(id){const ids=Object.keys(CATEGORIES);const idx=ids.indexOf(id);if(idx===-1)return;activeCatIdx=idx;sessionStorage.setItem('active_cat_idx',String(activeCatIdx));renderActiveCategory()}
  function goToSiblingCategory(dir){const ids=Object.keys(CATEGORIES);activeCatIdx=Math.min(ids.length-1,Math.max(0,activeCatIdx+dir));sessionStorage.setItem('active_cat_idx',String(activeCatIdx));renderActiveCategory()}
  function showSwipeHintOnce(){if(sessionStorage.getItem('swipe_hint_shown'))return;sessionStorage.setItem('swipe_hint_shown','1');const h=document.createElement('div');h.className='swipe-hint';h.textContent='Свайпайте по экрану — следующий раздел';document.body.appendChild(h);setTimeout(()=>h.remove(),2600)}

  function showLangGate(){const g=$('#lang-gate');if(g)g.style.display='flex'}
  function hideLangGate(){const g=$('#lang-gate');if(g)g.style.display='none'}

  function openDishModal(){const d=ITEMS['kazan_kebab'];if(!d)return;const m=$('#dish-modal');if(!m)return;$('#dish-modal-image').src='казан-кабоб.webp';$('#dish-modal-title').textContent=locName(d.name);$('#dish-modal-desc').textContent=HERO_DESC_BY_ID[lang]?.kazan_kebab||'';$('#dish-modal-price').textContent=fmt(d.price);m.style.display='flex';document.body.style.overflow='hidden'}
  function closeDishModal(){const m=$('#dish-modal');if(!m)return;m.style.display='none';document.body.style.overflow=''}

  function updateDecorPositions(){
    const donkey=$('#donkey-art');const left=$('#left-art');const footer=$('footer');const menu=$('#menu-root');if(!donkey||!left||!footer||!menu)return;
    const scrollY=window.scrollY;const footerTopAbs=footer.getBoundingClientRect().top+scrollY;const dH=donkey.getBoundingClientRect().height;const viewportBottom=scrollY+window.innerHeight;
    if(viewportBottom>=footerTopAbs){donkey.style.position='absolute';donkey.style.top=(footerTopAbs-dH)+'px';donkey.style.right='0px';donkey.style.bottom=''}else{donkey.style.position='fixed';donkey.style.bottom='0px';donkey.style.right='0px';donkey.style.top=''}
    const menuRect=menu.getBoundingClientRect();left.style.position='fixed';left.style.left='0px';left.style.top=menuRect.top+'px'
  }

  function preloadHeroImages(){ HERO_IDS.forEach(id=>{ const img=new Image(); img.src=HERO_IMG_SRC[id]; img.decode?.().catch(()=>{}); }); }
  function init(){
    renderTopCopy();preloadHeroImages();startHero();enableHeroManual();renderActiveCategory();if(!localStorage.getItem('boboy_lang'))showLangGate();updateDecorPositions();setupEventListeners();bindLangButtons();
    $('#dish-modal')?.addEventListener('click',e=>{if(e.target.id==='dish-modal')closeDishModal()});$('#dish-modal-close')?.addEventListener('click',closeDishModal);window.addEventListener('keydown',e=>{if(e.key==='Escape')closeDishModal()});
  }

  init();
  </script>
</body>
</html>
